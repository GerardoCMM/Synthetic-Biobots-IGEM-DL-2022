rownames(upNotf20)<-upNotf20$Gene.ID
upNotf20 <- upNotf20[2:7]
upNotf20 <- merge(upNotf20, acrossGroupsTable, by =0)
rownames(upNotf20)<-upNotf20$Row.names
upNotf20 <- upNotf20[2:13]
write.csv(upNotf20,"upNotf20.csv")
View(f40vsf20)
View(fullTable)
View(genes_up_Table)
f20vspan <- results(dds,c("condition","fruit_20d","panicle"))
f20vsleaf <- results(dds,c("condition","fruit_20d","leaf"))
View(f20vsleaf)
f20vspan <- as.data.frame(f20vspan)
f20vsleaf <- as.data.frame(f20vsleaf)
View(f20vsleaf)
f20vspan <- f20vspan[!is.na(f20vspan$padj), ]
f20vsleaf <- f20vsleaf[!is.na(f20vsleaf$padj), ]
colnames(f20vspan) <- paste0("f20vspan", "_", colnames(f20vspan))
colnames(f20vsleaf) <- paste0("f20vsleaf", "_", colnames(f20vsleaf))
View(f20vspan)
View(f20vsleaf)
fullTable2 <- merge(f40vsf20, f40vspan, by =0)
rownames(fullTable2) <- fullTable2$Row.names
fullTable2 <- fullTable2[,2:5]
View(fullTable2)
fullTable2 <- merge(f40vsleaf, f40vspan, by =0)
rownames(fullTable2) <- fullTable2$Row.names
fullTable2 <- fullTable2[,2:5]
View(fullTable2)
fullTable2 <- merge(fullTable2, f20vsleaf, by =0)
View(fullTable2)
f20vspan <- f20vspan[ , c("log2FoldChange", "padj")]
f20vspan <- results(dds,c("condition","fruit_20d","panicle"))
f20vsleaf <- results(dds,c("condition","fruit_20d","leaf"))
f20vspan <- as.data.frame(f20vspan)
f20vsleaf <- as.data.frame(f20vsleaf)
f20vspan <- f20vspan[!is.na(f20vspan$padj), ]
f20vsleaf <- f20vsleaf[!is.na(f20vsleaf$padj), ]
f20vspan <- f20vspan[ , c("log2FoldChange", "padj")]
f20vsleaf <- f20vsleaf[ , c("log2FoldChange", "padj")]
colnames(f20vspan) <- paste0("f20vspan", "_", colnames(f20vspan))
colnames(f20vsleaf) <- paste0("f20vsleaf", "_", colnames(f20vsleaf))
fullTable2 <- merge(f40vsleaf, f40vspan, by =0)
rownames(fullTable2) <- fullTable2$Row.names
fullTable2 <- fullTable2[,2:5]
fullTable2 <- merge(fullTable2, f20vsleaf, by =0)
fullTable2 <- merge(fullTable2, f20vspan, by =0)
View(fullTable2)
fullTable2 <- merge(f40vsleaf, f40vspan, by =0)
rownames(fullTable2) <- fullTable2$Row.names
fullTable2 <- fullTable2[,2:5]
fullTable2 <- merge(fullTable2, f20vsleaf, by =0)
View(fullTable2)
rownames(fullTable2) <- fullTable2$Row.names
View(fullTable2)
fullTable2 <- fullTable2[,2:7]
fullTable2 <- merge(fullTable2, f20vspan, by =0)
View(fullTable2)
View(fullTable)
upInF <-  fullTable2$f20vspan_log2FoldChange > 1 & fullTable2$f20vspan_padj < 0.05 &
fullTable2$f20vsleaf_log2FoldChange > 1 & fullTable2$f20vsleaf_padj < 0.05 &
fullTable2$f40vspan_log2FoldChange > 1 & fullTable2$f40vspan_padj < 0.05 &
fullTable2$f40vsleaf_log2FoldChange > 1 & fullTable2$f40vsleaf_padj < 0.05
upInF <- fullTable2[upInF, ]
upInF<-Genes_Anot[which(Genes_Anot$Gene.ID%in%upInF$Row.names),c(1,2,35,36,37,39,40,41)]
View(upInF)
upInF <-  fullTable2$f20vspan_log2FoldChange > 1 & fullTable2$f20vspan_padj < 0.05 &
fullTable2$f20vsleaf_log2FoldChange > 1 & fullTable2$f20vsleaf_padj < 0.05 &
fullTable2$f40vspan_log2FoldChange > 1 & fullTable2$f40vspan_padj < 0.05 &
fullTable2$f40vsleaf_log2FoldChange > 1 & fullTable2$f40vsleaf_padj < 0.05
upInF <- fullTable2[upInF, ]
upInF<-Genes_Anot[which(Genes_Anot$Gene.ID%in%upInF$Row.names),c(1,2,35,36,37,39,40,41)]
rownames(upInF)<-upInF$Gene.ID
upInF <- upInF[2:7]
upInF <- merge(upInF, acrossGroupsTable, by =0)
rownames(upInF)<-upInF$Row.names
upInF <- upInF[2:13]
write.csv(upInF,"upInF.csv")
library("DEXSeq")
setwd("/home/gerardo/Documentos/Gera/SyntheticBiobots/2022/Metods/Exon_usage")
plotDEXSeq( dxr1, "Pn3.4770", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.2282", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.2282", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.2282", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn2.2377", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn2.2377", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn2.2377", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
"Pn3.4770" in rownames(upAnot)
"Pn3.4770"%in%rownames(upAnot)
View(upAnot)
genesForSubset = c(rownames(difInf40Counts),"Pn3.4770")
"Pn3.4770"%in%genesForSubset
setwd("/home/gerardo/Documentos/Gera/SyntheticBiobots/2022/Metods/Exon_usage")
library("DEXSeq")
countFiles <- c('./ERR4099794.tabular',
'./ERR4099795.tabular',
'./ERR4099796.tabular',
'./ERR4099797.tabular',
'./ERR4099798.tabular',
'./ERR4099799.tabular',
'./ERR4099800.tabular',
'./ERR4099801.tabular',
'./ERR4099802.tabular',
'./ERR4099803.tabular',
'./ERR4099804.tabular',
'./ERR4099805.tabular')
flattenedFile = "./Transcripts/genome_flattened_2.gff"
sampleTable <- data.frame(condition = factor(c(rep("fruit_20d",3),rep("fruit_40d",3),rep("leaf",3),rep("panicle",3))))
dxd = DEXSeqDataSetFromHTSeq(
countFiles,
sampleData=sampleTable,
design= ~ sample + exon + condition:exon,
flattenedfile=flattenedFile )
genesForSubset = c(rownames(difInf40Counts),"Pn3.4770")
dxd = dxd[geneIDs( dxd ) %in% genesForSubset,]
dxd = estimateSizeFactors( dxd )
dxd = estimateDispersions( dxd )
plotDispEsts( dxd )
dxd = testForDEU( dxd )
dxd = estimateExonFoldChanges( dxd, fitExpToVar="condition")
dxr1 = DEXSeqResults( dxd )
table ( dxr1$padj < 0.05 )
table ( tapply( dxr1$padj < 0.1, dxr1$groupID, any ) )
plotMA( dxr1, cex=0.8 )
plotDEXSeq( dxr1, "Pn16.1237", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn2.2377", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
View(dxr1)
dfdxr1 = as.data.frame(dxr1)
View(dfdxr1)
sampleTable$condition
levels(sampleTable$condition)
sampleTable <- data.frame(condition = factor(c(rep("fruit_20d",3),rep("fruit_40d",3),rep("leaf",3),rep("panicle",3))))
sampleTable$condition <- relevel(sampleTable$condition,ref="fruit_40d")
levels(sampleTable$condition)
dxd = DEXSeqDataSetFromHTSeq(
countFiles,
sampleData=sampleTable,
design= ~ sample + exon + condition:exon,
flattenedfile=flattenedFile )
genesForSubset = c(rownames(difInf40Counts),"Pn3.4770")
dxd = dxd[geneIDs( dxd ) %in% genesForSubset,]
dxd = estimateSizeFactors( dxd )
dxd = estimateDispersions( dxd )
plotDispEsts( dxd )
dxd = testForDEU( dxd )
dxd = estimateExonFoldChanges( dxd, fitExpToVar="condition")
dxr1 = DEXSeqResults( dxd )
dfdxr1 = as.data.frame(dxr1)
View(dfdxr1)
table ( dxr1$padj < 0.05 )
table ( tapply( dxr1$padj < 0.1, dxr1$groupID, any ) )
plotMA( dxr1, cex=0.8 )
plotDEXSeq( dxr1, "Pn16.1237", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
setwd("/home/gerardo/Documentos/Gera/SyntheticBiobots/2022/Metods/Exon_usage")
library("DEXSeq")
View(dfdxr1)
plotDEXSeq( dxr1, "Pn3.4770", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
setwd("/home/gerardo/Documentos/Gera/SyntheticBiobots/2022/Metods/Exon_usage")
library("DEXSeq")
countFiles <- c('./ERR4099794.tabular',
'./ERR4099795.tabular',
'./ERR4099796.tabular',
'./ERR4099797.tabular',
'./ERR4099798.tabular',
'./ERR4099799.tabular',
'./ERR4099800.tabular',
'./ERR4099801.tabular',
'./ERR4099802.tabular',
'./ERR4099803.tabular',
'./ERR4099804.tabular',
'./ERR4099805.tabular')
flattenedFile = "./Transcripts/genome_flattened_2.gff"
sampleTable <- data.frame(condition = factor(c(rep("fruit_20d",3),rep("fruit_40d",3),rep("leaf",3),rep("panicle",3))))
sampleTable$condition <- relevel(sampleTable$condition,ref="fruit_40d")
dxd = DEXSeqDataSetFromHTSeq(
countFiles,
sampleData=sampleTable,
design= ~ sample + exon + condition:exon,
flattenedfile=flattenedFile )
genesForSubset = c(rownames(difInf40Counts),"Pn3.4770")
dxd = dxd[geneIDs( dxd ) %in% genesForSubset,]
dxd = estimateSizeFactors( dxd )
dxd = estimateDispersions( dxd )
plotDispEsts( dxd )
dxd = testForDEU( dxd )
dxd = estimateExonFoldChanges( dxd, fitExpToVar="condition")
dxr1 = DEXSeqResults( dxd )
dfdxr1 = as.data.frame(dxr1)
table ( dxr1$padj < 0.05 )
table ( tapply( dxr1$padj < 0.1, dxr1$groupID, any ) )
plotMA( dxr1, cex=0.8 )
plotDEXSeq( dxr1, "Pn16.1237", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn2.2377", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn2.2377", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn2.2377", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn45.43", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn45.43", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn45.43", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDispEsts( dxd )
plotMA( dxr1, cex=0.8 )
plotDEXSeq( dxr1, "Pn3.4770", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
View(dfdxr1)
#####
plotDEXSeq( dxr1, "Pn3.4770", norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
#####
plotDEXSeq( dxr1, "Pn3.4770", splicing = TRUE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
#####
plotDEXSeq( dxr1, "Pn3.4770", splicing = TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn45.43", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn45.43", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn45.43", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn45.43", splicing = TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn2.2377", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn2.2377", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn2.2377", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn2.2377", splicing = TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
View(dfdxr1)
plotDEXSeq( dxr1, "Pn16.1237", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn16.1237", splicing = TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", splicing = TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", splicing = TRUE, displayTranscripts=TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", splicing = TRUE, displayTranscripts=TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn3.4770", splicing = TRUE, displayTranscripts=TRUE, norCounts=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
View(dfdxr1)
View(txi_output)
_sampleInfo <- dfdxr1[dfdxr1$groupID=="Pn3.4770",]
f_sampleInfo <- dfdxr1[dfdxr1$groupID=="Pn3.4770",]
View(f_sampleInfo)
f_sampleInfo <- dfdxr1[dfdxr1$groupID=="Pn3.4770",20:31]
_sampleTable <- data.frame(condition = factor(c(rep("fruit_20d",3),rep("fruit_40d",3),rep("leaf",3),rep("panicle",3))))
f_sampleTable <- data.frame(condition = factor(c(rep("fruit_20d",3),rep("fruit_40d",3),rep("leaf",3),rep("panicle",3))))
f_coldata <- f_sampleTable
f_coldata$condition <- relevel(f_coldata$condition,ref="fruit_40d")
View(f_coldata)
View(f_coldata)
colnames(f_sampleInfo) <- f_coldata$condition
dds <- DESeqDataSetFromMatrix(countData = f_sampleInfo,
colData = coldata,
design= ~ condition)
_dds <- DESeqDataSetFromMatrix(countData = f_sampleInfo,
colData = coldata,
design= ~ condition)
colnames(f_sampleInfo) <- f_coldata$condition
f_dds <- DESeqDataSetFromMatrix(countData = f_sampleInfo,
colData = coldata,
design= ~ condition)
dds <- DESeqDataSetFromTximport(txi = txi_output,
colData = coldata,
design= ~ condition)
f_dds <- DESeq(dds)
f_dds <- DESeq(f_dds)
f_resultados <- as.data.frame(results(f_dds))
View(f_resultados)
f_dds <- DESeqDataSetFromMatrix(countData = f_sampleInfo,
colData = coldata,
design= ~ condition)
f_dds <- DESeq(f_dds)
f_resultados <- as.data.frame(results(f_dds))
k
PD
View(sampleCor)
PieDonut(PD, aes(Cluster, GO.Molecular.Functions, count=n), title = "GO Molecular function of diferentially genes")
library(webr)
PieDonut(PD, aes(Cluster, GO.Molecular.Functions, count=n), title = "GO Molecular function of diferentially genes")
library(ggplot2)
PieDonut(PD, aes(Cluster, GO.Molecular.Functions, count=n), title = "GO Molecular function of diferentially genes")
pwd()
wd()
getwd()
setwd("../Exon_usage")
getwd()
genesForSubset = c(rownames(difInf40Counts),"Pn3.4770", "Pn8.2617") # Using only differentially expressed genes and genes of importance for the pathway
dxd = dxd[geneIDs( dxd ) %in% genesForSubset,]
dxd = estimateSizeFactors( dxd )
dxd = estimateDispersions( dxd )
plotDispEsts( dxd )
dxd = testForDEU( dxd ) # Test for diferential exon usage
dxd = estimateExonFoldChanges( dxd, fitExpToVar="condition")
dxr1 = DEXSeqResults( dxd )
dfdxr1 = as.data.frame(dxr1)
table ( dxr1$padj < 0.05 )
table ( tapply( dxr1$padj < 0.1, dxr1$groupID, any ) )
table ( tapply( dxr1$padj < 0.05, dxr1$groupID, any ) )
plotMA( dxr1, cex=0.8 )
table ( dxr1$padj < 0.05 ) # How many exonic regions are significant
table ( tapply( dxr1$padj < 0.05, dxr1$groupID, any ) ) # How many genes are significant
plotMA( dxr1, cex=0.8 )
numbOfGenes <- sum( perGeneQValue(dxr) < 0.05)
numbOfGenes <- sum( perGeneQValue(dxr1) < 0.05)
numbOfGenes
plotMA( dxr1, FDR=0.05)
plotMA( dxr1, cex = 0.8, FDR=0.05)
plotMA( dxr1, cex = 0.8)
plotDispEsts( dxd )
plotMA( dxr1, cex = 0.8)
plotMA( dxr1, cex = 0.8, p = 0.05)
plotMA( dxr1, cex = 0.8, pvalue = 0.05)
table ( dxr1$padj < 0.1 ) # How many exonic regions are significant
table ( tapply( dxr1$padj < 0.1, dxr1$groupID, any ) ) # How many genes are significant
numbOfGenes <- sum( perGeneQValue(dxr1) < 0.1) # Number of genes with at least one differentially used exon (False discovery rate == 0.05)
numbOfGenes
plotMA( dxr1, cex = 0.8)
plotMA( dxr1, cex = 0.8, col="green")
plotMA( dxr1, cex = 0.8)
View(dfdxr1)
max(dfdxr1$exonBaseMean)
dxr1 = DEXSeqResults( dxd ) # Obtaining results
dfdxr1 = as.data.frame(dxr1) # Conversion to data.frame
View(dfdxr1)
plotMA( dxr1, cex = 1)
plotMA( dxr1, cex = 1, colNonSig = "blue")
plotMA( dxr1, cex = 1, colNonSig = "cyan")
plotMA( dxr1, cex = 1, colNonSig = "cyan3")
plotDispEsts( dxd ) # Plot dispersions
plotDispEsts( dxd, cex = 1) # Plot dispersions
plotDEXSeq( dxr1, "Pn8.2617", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
View(dfdxr1)
genesForSubset = c(rownames(difInf40Counts), "Pn8.2617","Pn3.4770") # Using only differentially expressed genes and genes of importance for the pathway
dxd = DEXSeqDataSetFromHTSeq(
countFiles,
sampleData=sampleTable,
design= ~ sample + exon + condition:exon,
flattenedfile=flattenedFile ) # Loading files and experimental design
genesForSubset = c(rownames(difInf40Counts), "Pn8.2617","Pn3.4770") # Using only differentially expressed genes and genes of importance for the pathway
dxd = dxd[geneIDs( dxd ) %in% genesForSubset,]
dxd = estimateSizeFactors( dxd ) # Normalisation
dxd = estimateDispersions( dxd ) # Dispersion estimation
plotDispEsts( dxd, cex = 1) # Plot dispersions
dxd = testForDEU( dxd ) # Test for diferential exon usage
dxd = estimateExonFoldChanges( dxd, fitExpToVar="condition") # Exon usage fold changes
dxr1 = DEXSeqResults( dxd ) # Obtaining results
dfdxr1 = as.data.frame(dxr1) # Conversion to data.frame
table ( dxr1$padj < 0.1 ) # How many exonic regions are significant
table ( tapply( dxr1$padj < 0.1, dxr1$groupID, any ) ) # How many genes are significant
numbOfGenes <- sum( perGeneQValue(dxr1) < 0.1) # Number of genes with at least one differentially used exon (False discovery rate == 0.05)
numbOfGenes
plotMA( dxr1, cex = 1, colNonSig = "cyan3") # Plotting mean expression of exonic part, log 2 fold change and significance (FDR = 0.1)
plotDEXSeq( dxr1, "Pn8.2617", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn8.2617", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn8.2617", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn8.2617", splicing = TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn8.2617", splicing = TRUE, displayTranscripts=TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 5
plotDEXSeq( dxr1, "Pn8.2617", splicing = TRUE, displayTranscripts=TRUE, norCounts=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 )
plotDEXSeq( dxr1, "Pn8.2617", splicing = TRUE, norCounts=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 6 Expression and exon usage
plotDEXSeq( dxr1, "Pn3.4770", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 1 Expression
plotDEXSeq( dxr1, "Pn3.4770", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 2 Expression with transcripts
plotDEXSeq( dxr1, "Pn3.4770", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 3 Normalized counts
plotDEXSeq( dxr1, "Pn3.4770", splicing = TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 4 Exon usage
plotDEXSeq( dxr1, "Pn3.4770", splicing = TRUE, displayTranscripts=TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 5 Exon usage with transcripts
plotDEXSeq( dxr1, "Pn3.4770", splicing = TRUE, norCounts=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 6 Expression and exon usage
plotDEXSeq( dxr1, "Pn3.4770", splicing = TRUE, displayTranscripts=TRUE, norCounts=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 7 Expression and exon usage with transcripts
extra = ("Pn8.2617", "Pn2.84", "Pn3.4770")
extra = ("Pn8.2617", "Pn2.84", "Pn3.4770")
extra = ("Pn8.2617", "Pn2.84", "Pn3.4770")
extra = c("Pn8.2617", "Pn2.84", "Pn3.4770")
genesForSubset = c(rownames(difInf40Counts), extra) # Using only differentially expressed genes and genes of importance for the pathway
dxd = dxd[geneIDs( dxd ) %in% genesForSubset,]
dxd = DEXSeqDataSetFromHTSeq(
countFiles,
sampleData=sampleTable,
design= ~ sample + exon + condition:exon,
flattenedfile=flattenedFile ) # Loading files and experimental design
setwd("../Exon_usage") # Moving to Exon_usage directory
library("DEXSeq") # Loading DEXSeq library
countFiles <- c('./ERR4099794.tabular',
'./ERR4099795.tabular',
'./ERR4099796.tabular',
'./ERR4099797.tabular',
'./ERR4099798.tabular',
'./ERR4099799.tabular',
'./ERR4099800.tabular',
'./ERR4099801.tabular',
'./ERR4099802.tabular',
'./ERR4099803.tabular',
'./ERR4099804.tabular',
'./ERR4099805.tabular') # Files with counts for every exon of every gene
flattenedFile = "./Transcripts/genome_flattened_2.gff" # This file includes all the know transcripts for the proteins previously know
sampleTable <- data.frame(condition = factor(c(rep("fruit_20d",3),rep("fruit_40d",3),rep("leaf",3),rep("panicle",3))))
sampleTable$condition <- relevel(sampleTable$condition,ref="fruit_40d") # Using fruit at 40 days stage as reference
dxd = DEXSeqDataSetFromHTSeq(
countFiles,
sampleData=sampleTable,
design= ~ sample + exon + condition:exon,
flattenedfile=flattenedFile ) # Loading files and experimental design
extra = c("Pn8.2617", "Pn2.84", "Pn3.4770")
genesForSubset = c(rownames(difInf40Counts), extra) # Using only differentially expressed genes and genes of importance for the pathway
dxd = dxd[geneIDs( dxd ) %in% genesForSubset,]
dxd = estimateSizeFactors( dxd ) # Normalisation
dxd = estimateDispersions( dxd ) # Dispersion estimation
plotDispEsts( dxd, cex = 1) # Plot dispersions
dxd = testForDEU( dxd ) # Test for diferential exon usage
dxd = estimateExonFoldChanges( dxd, fitExpToVar="condition") # Exon usage fold changes
dxr1 = DEXSeqResults( dxd ) # Obtaining results
dfdxr1 = as.data.frame(dxr1) # Conversion to data.frame
table ( dxr1$padj < 0.1 ) # How many exonic regions are significant
table ( tapply( dxr1$padj < 0.1, dxr1$groupID, any ) ) # How many genes are significant
numbOfGenes <- sum( perGeneQValue(dxr1) < 0.1) # Number of genes with at least one differentially used exon (False discovery rate == 0.05)
plotMA( dxr1, cex = 1, colNonSig = "cyan3") # Plotting mean expression of exonic part, log 2 fold change and significance (FDR = 0.1)
plotDEXSeq( dxr1, "Pn2.84", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 1 Expression
plotDEXSeq( dxr1, "Pn2.84", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 2 Expression with transcripts
plotDEXSeq( dxr1, "Pn2.84", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 3 Normalized counts
plotDEXSeq( dxr1, "Pn2.84", splicing = TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 4 Exon usage
plotDEXSeq( dxr1, "Pn2.84", splicing = TRUE, displayTranscripts=TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 5 Exon usage with transcripts
plotDEXSeq( dxr1, "Pn2.84", splicing = TRUE, norCounts=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 6 Expression and exon usage
plotDEXSeq( dxr1, "Pn2.84", splicing = TRUE, displayTranscripts=TRUE, norCounts=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 7 Expression and exon usage with transcripts
extra = c("Pn8.2617", "Pn2.84", "Pn1.1317", "Pn3.4770", "Pn16.1237",
"Pn4.3222", "Pn2.2377", "Pn12.1813")
dxd = DEXSeqDataSetFromHTSeq(
countFiles,
sampleData=sampleTable,
design= ~ sample + exon + condition:exon,
flattenedfile=flattenedFile ) # Loading files and experimental design
extra = c("Pn8.2617", "Pn2.84", "Pn1.1317", "Pn3.4770", "Pn16.1237",
"Pn4.3222", "Pn2.2377", "Pn12.1813")
genesForSubset = c(rownames(difInf40Counts), extra) # Using only differentially expressed genes and genes of importance for the pathway
dxd = dxd[geneIDs( dxd ) %in% genesForSubset,]
dxd = estimateSizeFactors( dxd ) # Normalisation
dxd = estimateDispersions( dxd ) # Dispersion estimation
plotDispEsts( dxd, cex = 1) # Plot dispersions
dxd = testForDEU( dxd ) # Test for diferential exon usage
dxd = estimateExonFoldChanges( dxd, fitExpToVar="condition") # Exon usage fold changes
dxr1 = DEXSeqResults( dxd ) # Obtaining results
dfdxr1 = as.data.frame(dxr1) # Conversion to data.frame
table ( dxr1$padj < 0.1 ) # How many exonic regions are significant
table ( tapply( dxr1$padj < 0.1, dxr1$groupID, any ) ) # How many genes are significant
numbOfGenes <- sum( perGeneQValue(dxr1) < 0.1) # Number of genes with at least one differentially used exon (False discovery rate == 0.05)
plotMA( dxr1, cex = 1, colNonSig = "cyan3") # Plotting mean expression of exonic part, log 2 fold change and significance (FDR = 0.1)
plotDEXSeq( dxr1, "Pn2.84", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 1 Expression
plotDEXSeq( dxr1, "Pn2.84", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 2 Expression with transcripts
plotDEXSeq( dxr1, "Pn1.1317", legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 1 Expression
plotDEXSeq( dxr1, "Pn1.1317", displayTranscripts=TRUE, legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 2 Expression with transcripts
plotDEXSeq( dxr1, "Pn1.1317", expression=FALSE, norCounts=TRUE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 3 Normalized counts
plotDEXSeq( dxr1, "Pn1.1317", splicing = TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 4 Exon usage
plotDEXSeq( dxr1, "Pn1.1317", splicing = TRUE, displayTranscripts=TRUE, norCounts=FALSE,expression=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 5 Exon usage with transcripts
plotDEXSeq( dxr1, "Pn1.1317", splicing = TRUE, norCounts=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 6 Expression and exon usage
plotDEXSeq( dxr1, "Pn1.1317", splicing = TRUE, displayTranscripts=TRUE, norCounts=FALSE,
legend=TRUE, cex.axis=1.2, cex=1.3, lwd=2 ) # 7 Expression and exon usage with transcripts
